# Отчет по лабораторной работе №3 
## "Изучение технологии AJAX"

#### Цель работы:   
  
Разработать и реализовать анонимный чат с возможностью создания каналов. В интерфейсе отображается несколько каналов, пользователь может либо подключиться к существующему, либо создать новый. Сообщения доставляются пользователю без обновления страницы.

#### Пользовательский интерфейс:

* Форма входа:

![loginform](https://github.com/FedrovSergey/lab3_chat/blob/main/images%20for%20readme/%D1%87%D0%B0%D1%82%20%D0%B0%D0%B2%D1%82%D0%BE%D1%80%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F.png)

* Форма регистрации:

![registerform](https://github.com/FedrovSergey/lab3_chat/blob/main/images%20for%20readme/%D1%87%D0%B0%D1%82%20%D1%80%D0%B5%D0%B3%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%86%D0%B8%D1%8F.png)

* Вид зарегистрированного пользователя:

![index](https://github.com/FedrovSergey/lab3_chat/blob/main/images%20for%20readme/%D1%87%D0%B0%D1%82%20%D0%B2%D0%B8%D0%B4%20%D0%B2%D1%8B%D0%B1%D0%BE%D1%80%D0%B0%20%D1%87%D0%B0%D1%82%D0%B0.png)

* Вид чата:

![chat](https://github.com/FedrovSergey/lab3_chat/blob/main/images%20for%20readme/%D1%87%D0%B0%D1%82%20%D0%BF%D0%B5%D1%80%D0%B5%D0%BF%D0%B8%D1%81%D0%BA%D0%B0.png)

#### Пользовательские сценарии работы:

1. Пользователь вводит в адресной строке main.php и попадает на форму регистрации. После регистрации пользователь попадает на страницу с каналами.
2. Выбрав канал, пользователь попадает на страницу сhat.php с определенным пользователем. 
3. Дальше пользователь может написать и отправить сообщение. Также виден статус пользователя (онлайн или оффлайн).

#### API сервера и хореография:

Сервер работает с помощью GET-запросов, POST-запросов и AJAX-запросов.   
Также используются глобальные переменные, такие как $_SESSION[*name*] и другие. 

main.php, при отсутствии переменной $_SESSION['user'], перенаправляет пользователя на страницу auth.php. Если переменная есть, то перенаправление не происходит. При нажатии на кнопку Logout сервер отправляет запрос в logout.php (в результате запроса переменная $_SESSION['user']) будет уничтожена и направляет пользователя на auth.php.

Со страницы auth.php, при нажатии кнопки "Signup", сервер отправляет запрос на signup.php (тут данные будут проверены и, если всё ок, внесены в БД), передавая туда введённые в поля "First name", "Second name", "Email adress", "Password"  и "Image" данные. signup.php после обработки данных возвращает индикатор, в зависимости от значения которого будет выведено сообщение об ошибке или успешной регистрации.

При нажатии на странице auth.php кнопки "Login now", сервер направит на signin.php запрос с введёнными данными. signin.php проверяет данные на корректность и возвращает индикатор, в зависимости от значения которого будет выведено сообщение об ошибке или пользователь получит переменную $_SESSION['user']) и будет перенаправлен на main.php.

Со страницы main.php, при нажатии на пользователя которому ты хочешь написать сообщение, перенаправляет пользователя на страницу chat.php. chat.php отправляет запрос на добавление нового сообщения.

#### Структура базы данных:

Используются две таблицы:

- Таблица messages:

`msg_id` int(11) - идентификатор сообщения
   
`incoming_msg_id` int(255) - идентификатор получателя
  
`outgoing_msg_id` int(255) - идентификатор отправителя
  
`msg` varchar(1000) - сообщение
  
- Таблица users:

`user_id` int(11) - количество идентификаторов пользователей

`unique_id` int(255) - идентификатор пользователя
  
`fname` varchar(255) - Имя
  
`lname` varchar(255) - Фамилия
  
  `email` varchar(255) - почта
  
  `password` varchar(255) - пароль
  
  `img` varchar(255) - изображение
  
  `status` varchar(255) - онлайн/оффлайн

#### Алгоритмы работы: 

* Алгоритм регистрации:

![first_diagram](https://github.com/FedrovSergey/lab3_chat/blob/main/images%20for%20readme/%D1%80%D0%B5%D0%B3%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%20%D1%87%D0%B0%D1%82%D0%B5.png)

* Алгоритм переписки:

![second_diagram](https://github.com/FedrovSergey/lab3_chat/blob/main/images%20for%20readme/%D0%BF%D0%B5%D1%80%D0%B5%D0%BF%D0%B8%D1%81%D0%BA%D0%B0%20%D0%B2%20%D1%87%D0%B0%D1%82%D0%B5.png)

код:


